import{a as y,_ as b,P as C,Q as v,R as S,r as T,b as k,o as m,c as p,e as s,t as r,g as w,v as L,z as M,f as _,F as P,l as $,i as W,d as I,h as f,n as B,B as H,C as A}from"./index.8b30e6a1.js";import{f as F}from"./getRegularNumber.a168e36c.js";import{S as D}from"./SecurityNoticeModal.0dee1ea1.js";import{W as O}from"./WalletHistory.4d4db630.js";import{I as U}from"./InfoModal.fb2c8c4b.js";import{W as V}from"./WalletDepositSepaFialModal.5274143e.js";import"./long-arrow-right.6b4bc820.js";var Z={methods:{loadWallets(){y.config.globalProperties.$http.post("getwallets/",{}).then(e=>{e.data.forEach(t=>{!this.coins[t.currency]||(this.coins[t.currency].address||(this.coins[t.currency].address=t),Array.isArray(this.coins[t.currency].address)&&!this.coins[t.currency].address.find(o=>o.address===t.address)&&(this.coins[t.currency].address=[...this.coins[t.currency].address,t]),typeof this.coins[t.currency].address=="object"&&!Array.isArray(this.coins[t.currency].address)&&this.coins[t.currency].address!==null&&this.coins[t.currency].address.address!==t.address&&(this.coins[t.currency].address=[this.coins[t.currency].address,t]))})})}}},N="/public/sprite.svg";const j={name:"WalletPage",metaInfo(){return{title:this.$t("pages.titles.wallet"),meta:[{name:"description",content:`${this.localConfig.project_title} ${this.$t("pages.walletDescription")}`}]}},components:{WalletHistory:O},mixins:[C,v,Z],data(){return{hideLess:!1,sortField:"",sortTypeAsc:!0,searchParameter:"",isInitialized:!1,payout_form_view:"pending",errorMSGwithADVCASH:"",currencyWWWwithINTERKASSA:"USDT",curPage:1,txscount:0,amountOnPage:10,amountOfPages:1,timers:[],resend_loader:{},floor10:F}},computed:{...S({areCoinsLoaded:"core/areCoinsLoaded",coins:"core/coins",profile:"core/profile",isConnectedSocket:"isConnectedSocket",wsUserIsAuthenticated:"wsUserIsAuthenticated",user_notification:"core/user_notification",wallethistory:"core/wallethistory",reconnectError:"reconnectError",lockedBalance:"core/lockedBalance"}),filteredCoins(){let e=Object.fromEntries(Object.entries(this.coins).filter(o=>{let c=o[1].actual+o[1].orders;return this.hideLess?o[0].includes(this.searchParameter.toUpperCase())&&c>1e-4:o[0].includes(this.searchParameter.toUpperCase())})),t={};if(this.sortField!==""){let o=this.sortField,c=this.sortTypeAsc;t=Object.fromEntries(Object.entries(e).sort(function(n,l){let h=1,i,a;switch(o){case"currency":i=n[0].toLowerCase(),a=l[0].toLowerCase(),c?h=i<a?1:i>a?-1:0:h=i<a?-1:i>a?1:0;break;case"total":i=n[1].actual+n[1].orders,a=l[1].actual+l[1].orders,c?h=i<a?1:i>a?-1:0:h=i<a?-1:i>a?1:0;break;case"orders":i=n[1].orders,a=l[1].orders,c?h=i<a?1:i>a?-1:0:h=i<a?-1:i>a?1:0;break}return h}))}else t=e;return Object.fromEntries(Object.entries(t).filter(([,o])=>!o.disable_all))},filteredList(){return Object.entries(this.filteredCoins).filter(e=>e.currency.toUpperCase().includes(this.searchParameter.toUpperCase()))}},watch:{areCoinsLoaded:{immediate:!0,handler(e){e&&!this.isInitialized&&(this.init(),this.isInitialized=!0)}},isConnectedSocket(e){e&&localStorage.getItem("token")&&this.$store.dispatch("sendWSMessage",JSON.stringify({token:localStorage.getItem("token")}))},wsUserIsAuthenticated(e){e&&(this.getBalance(),this.getLockedBalance(),this.getWalletHistory())},user_notification(e){e.length&&this.$modal.show(U,{},{adaptive:!0,height:"auto",scrollable:!0,width:500})},reconnectError(e){e&&(this.updateWalletHistory(this.curPage,this.amountOnPage),this.updateBalance())}},beforeUnmount(){for(this.unsubscribeWsData();this.timers.length;)clearTimeout(this.timers.shift())},methods:{init(){this.sortField=localStorage.getItem("sort-field")||"",this.sortTypeAsc=localStorage.getItem("sort-asc")==="1"||"",this.loadWallets(),this.showSecurityNotice(),this.$store.dispatch("core/getUserNotifications"),this.isConnectedSocket&&(localStorage.getItem("token")&&this.$store.dispatch("sendWSMessage",JSON.stringify({token:localStorage.getItem("token")})),this.wsUserIsAuthenticated&&(this.getBalance(),this.getLockedBalance(),this.getWalletHistory()))},sortWalletTable(e){e!==this.sortField?(this.sortTypeAsc=!0,localStorage.setItem("sort-asc","1")):(this.sortTypeAsc=!this.sortTypeAsc,this.sortTypeAsc?localStorage.setItem("sort-asc","1"):localStorage.setItem("sort-asc","0")),this.sortField=e,localStorage.setItem("sort-field",e)},toDetails(e,t,o){o||this.$router.push({name:`wallet-${e}`,params:{walletitem:t}})},formatingCommission(e){const t=Object.values(e);return t.length>1?`${Math.min(...t)} - ${Math.max(...t)}`:t.length===1?`${t[0]}`:"0"},showLockedBalance(e){return this.lockedBalance[e]},getCoinWithdrawalFee(e){return e.fee.withdrawal[this.$config.currentWithdrawCardPaySystem]},getCoinDepositFee(e){return e.fee.deposit[this.$config.currentTopUpCardPaySystem]},sepaDepositButtonHandler(e){this.$modal.show(V,{currency:e},{adaptive:!0,height:"auto",scrollable:!0,width:500})},fromPagetoLimits(e){let t=this.amountOnPage,o=t*(e-1);return{limit:t,offset:o,pageNum:e}},getPageCount(){return this.amountOfPages},changePage(e){this.curPage=e},handlePagination(e){this.changePage(e),this.reconnectError?this.updateWalletHistory(e,this.amountOnPage):this.getWalletHistory(e,this.amountOnPage,!0)},getPrettyDate(e){let t=new Date;return t.setTime(parseInt(e)*1e3),t.toLocaleString("ru-RU")},updateTable(){this.getWalletHistory(this.curPage,this.amountOnPage,!0),this.reconnectError&&this.updateWalletHistory(this.curPage)},sendSocketMessage(e,t,o,c){let n={command:e};t&&Object.keys(t)&&(n.params=t),c&&(n.token=localStorage.getItem("token")||null),o&&(n.params.pair_name=`${this.currentPair[0]}-${this.currentPair[1]}`),this.$store.dispatch("sendWSMessage",JSON.stringify(n))},getBalance(){this.sendSocketMessage("add_balance",{},!1,!0)},getLockedBalance(){this.sendSocketMessage("add_locked_balance",{},!1,!0)},updateBalance(){this.$store.dispatch("core/getBalance")},updateWalletHistory(e,t){let o=t*(e-1);this.$store.dispatch("core/getWalletHistory",{limit:t,offset:o,page:e,fc:()=>{this.changePage(e)}})},getWalletHistory(e,t,o){const c=o?"get_wallet_history":"add_wallet_history";this.reconnectError||this.sendSocketMessage(c,{limit:t||10,page:e||1},!1,!0)},unsubscribeWsData(){this.sendSocketMessage("del_balance",{},!1,!0),this.sendSocketMessage("del_wallet_history",{},!1,!0)},showSecurityNoticeModal(){this.$modal.show(D,{},{adaptive:!0,height:"auto",scrollable:!0,width:500})},showSecurityNotice(){localStorage.getItem("show_security_notice")!="OFF"&&this.$http.post("check2fa/").then(t=>{const o=t.data==="OFF",c=!this.profile.withdrawals_sms_confirmation;o&&c&&this.showSecurityNoticeModal()})},formatAmount(e){return parseFloat(e)>0?e:0}}},u=e=>(H("data-v-25eac00a"),e=e(),A(),e),E=N+"#deposit",z={class:"w-full wallets-list"},x={class:"plate"},J={class:"wallet__title wallet__title--top"},R={class:"md:flex justify-start"},G={class:"search-input"},K=u(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"20",height:"20",viewBox:"0 0 256 256","xml:space":"preserve",class:"search-input-icon"},[s("defs"),s("g",{transform:"translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"},[s("path",{d:"M 87.803 77.194 L 68.212 57.602 c 9.5 -14.422 7.912 -34.054 -4.766 -46.732 c 0 0 -0.001 0 -0.001 0 c -14.495 -14.493 -38.08 -14.494 -52.574 0 c -14.494 14.495 -14.494 38.079 0 52.575 c 7.248 7.247 16.767 10.87 26.287 10.87 c 7.134 0 14.267 -2.035 20.445 -6.104 l 19.591 19.591 C 78.659 89.267 80.579 90 82.498 90 s 3.84 -0.733 5.305 -2.197 C 90.732 84.873 90.732 80.124 87.803 77.194 z M 21.48 52.837 c -8.645 -8.646 -8.645 -22.713 0 -31.358 c 4.323 -4.322 10 -6.483 15.679 -6.483 c 5.678 0 11.356 2.161 15.678 6.483 c 8.644 8.644 8.645 22.707 0.005 31.352 c -0.002 0.002 -0.004 0.003 -0.005 0.005 c -0.002 0.002 -0.003 0.003 -0.004 0.005 C 44.184 61.481 30.123 61.48 21.48 52.837 z",transform:" matrix(1 0 0 1 0 0) ","stroke-linecap":"round"})])],-1)),Q=["placeholder"],q={class:"input_checkbox hideSmall__checkbox"},X=u(()=>s("span",{class:"checkmark"},null,-1)),Y={class:"table-responsive"},ee={class:"walletTable"},te={class:"walletTable__header walletTable__header_val"},se={class:"walletTable__header walletTable__header_balans"},ae={class:"walletTable__header walletTable__header_order"},oe={class:"walletTable__header walletTable__header_locked-balance"},le=u(()=>s("th",{class:"walletTable__header walletTable__header_offset"},null,-1)),ie={class:"walletTable__header walletTable__header walletTable__header_button"},re={key:0},ne=["data-thead"],ce={class:"walletTable__item_main walletTable__item_main--coin"},de=["src","alt"],he={class:"walletTable__coin"},_e=["data-thead"],ue=["data-thead"],me=["data-thead"],pe=u(()=>s("td",{class:"walletTable__item walletTable__item--hide-mobile"},null,-1)),ge={class:"walletTable__item walletTable__item_button wallet-button-desktop",style:{"text-align":"right"}},we={class:"btn-group dropup dropup-line"},fe=["onClick"],ye={width:"18",height:"18",class:"inline"},be=["fill"],Ce=["onClick"],ve=u(()=>s("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"inline-block"},[s("path",{d:"M13.1667 3.83333L11.9917 5.00833L14.1417 7.16667H5.66666V8.83333H14.1417L11.9917 10.9833L13.1667 12.1667L17.3333 8L13.1667 3.83333ZM2.33332 2.16667H8.99999V0.5H2.33332C1.41666 0.5 0.666656 1.25 0.666656 2.16667V13.8333C0.666656 14.75 1.41666 15.5 2.33332 15.5H8.99999V13.8333H2.33332V2.16667Z"})],-1)),Se=["onClick"],Te=u(()=>s("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"inline-block"},[s("path",{d:"M11.5833 15.1417L12.4166 16.5917C11.6166 16.9583 10.7416 17.2 9.83331 17.2917V15.6083C10.45 15.5333 11.0333 15.375 11.5833 15.1417ZM2.39165 9.83334H0.708313C0.79998 10.75 1.04165 11.6167 1.40831 12.4167L2.85831 11.5833C2.62498 11.0333 2.46665 10.45 2.39165 9.83334ZM11.5833 2.85834L12.4166 1.40834C11.6166 1.04168 10.75 0.80001 9.83331 0.708344V2.39168C10.45 2.46668 11.0333 2.62501 11.5833 2.85834ZM15.6083 8.16668H17.2916C17.2 7.25001 16.9583 6.38334 16.5916 5.58334L15.1416 6.41668C15.375 6.96668 15.5333 7.55001 15.6083 8.16668ZM6.41665 15.1417L5.58331 16.5917C6.38331 16.9583 7.25831 17.2 8.16665 17.2917V15.6083C7.54998 15.5333 6.96665 15.375 6.41665 15.1417ZM8.16665 2.39168V0.708344C7.24998 0.80001 6.38331 1.04168 5.58331 1.40834L6.41665 2.85834C6.96665 2.62501 7.54998 2.46668 8.16665 2.39168ZM14.3 4.97501L15.75 4.13334C15.225 3.40834 14.5833 2.76668 13.8583 2.24168L13.0166 3.69168C13.5083 4.06668 13.9333 4.49168 14.3 4.97501ZM2.85831 6.41668L1.40831 5.58334C1.04165 6.38334 0.79998 7.25001 0.708313 8.16668H2.39165C2.46665 7.55001 2.62498 6.96668 2.85831 6.41668ZM15.6083 9.83334C15.5333 10.45 15.375 11.0333 15.1416 11.5833L16.5916 12.4167C16.9583 11.6167 17.2 10.7417 17.2916 9.83334H15.6083ZM13.025 14.3L13.8666 15.75C14.5916 15.225 15.2333 14.5833 15.7583 13.8583L14.3083 13.0167C13.9333 13.5083 13.5083 13.9333 13.025 14.3ZM4.97498 3.70001L4.14165 2.24168C3.40831 2.77501 2.77498 3.40834 2.24998 4.14168L3.69998 4.98334C4.06665 4.49168 4.49165 4.06668 4.97498 3.70001ZM3.69998 13.025L2.24998 13.8583C2.77498 14.5833 3.41665 15.225 4.14165 15.75L4.98331 14.3C4.49165 13.9333 4.06665 13.5083 3.69998 13.025ZM9.83331 4.83334H8.16665V9.34168L11.7416 12.9167L12.9166 11.7417L9.83331 8.65834V4.83334Z"})],-1)),ke={class:"w-full wallet-history"},Le={class:"plate"},Me={class:"wallet__title wallet__title--top"};function Pe(e,t,o,c,n,l){const h=T("WalletHistory"),i=k("pattern");return m(),p("div",null,[s("div",null,[s("div",z,[s("div",x,[s("div",J,r(e.$t("common.wallet")),1),s("div",R,[s("div",G,[K,w(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.searchParameter=a),type:"text",placeholder:e.$t("common.search_currency"),class:"tab-pane__search"},null,8,Q),[[L,n.searchParameter],[i,/^[a-zA-Z\s]{0,24}$/]])]),s("label",q,[w(s("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>n.hideLess=a),type:"checkbox",class:"input_hidden"},null,512),[[M,n.hideLess]]),X,_(" "+r(e.$t("common.hideSmallBallance")),1)])]),s("div",Y,[s("table",ee,[s("thead",null,[s("tr",null,[s("th",te,[_(r(e.$t("common.currency"))+" ",1),s("div",{class:"wallet__sortButton",onClick:t[2]||(t[2]=a=>l.sortWalletTable("currency"))})]),s("th",se,[_(r(e.$t("common.allbalance"))+" ",1),s("div",{class:"wallet__sortButton",onClick:t[3]||(t[3]=a=>l.sortWalletTable("total"))})]),s("th",ae,[_(r(e.$t("common.inorders"))+" ",1),s("div",{class:"wallet__sortButton",onClick:t[4]||(t[4]=a=>l.sortWalletTable("orders"))})]),s("th",oe,r(e.$t("common.lockedBalance")),1),le,s("th",ie,r(e.$t("common.action")),1)])]),l.filteredCoins?(m(),p("tbody",re,[(m(!0),p(P,null,$(l.filteredCoins,(a,d)=>(m(),p("tr",{key:"coin-"+d},[s("td",{class:"walletTable__item walletTable__item_val","data-thead":e.$t("common.currency")},[s("div",ce,[s("img",{width:"50",src:a.logo.length>0?a.logo:`/public/img/common/svgcrypto/${d.toLowerCase()}.svg`,alt:d.toUpperCase(),class:"mCS_img_loaded walletTable__item_img"},null,8,de),s("div",he,[s("strong",null,r(d),1),s("span",null,r(a.name),1)])])],8,ne),s("td",{class:"walletTable__item walletTable__item_balans","data-thead":e.$t("common.allbalance")},r(e.addSpaceFixDecimal(a.actual+a.orders,a.decimals)),9,_e),s("td",{class:"walletTable__item walletTable__item_order","data-thead":e.$t("common.inorders")},r(e.addSpaceFixDecimal(a.orders,a.decimals)),9,ue),s("td",{class:"walletTable__item walletTable__item_order","data-thead":e.$t("common.lockedBalance")},r(e.addSpaceFixDecimal(l.showLockedBalance(d),a.decimals)),9,me),pe,s("td",ge,[s("div",we,[s("span",{class:f(["wallet__action wallet__action--deposit",e.coins[d].disable_topups?"disabled":""]),style:B(e.mainColor?`color: ${e.secondColor} !important`:{}),onClick:g=>l.toDetails("deposit",d,e.coins[d].disable_topups)},[(m(),p("svg",ye,[s("use",{fill:e.mainColor?`${e.mainColor}`:"var(--theme-primary-color)",href:E},null,8,be)])),_(" "+r(e.$t("common.deposit").toUpperCase()),1)],14,fe),s("span",{class:f(["wallet__action wallet__action--withdrawal",e.coins[d].disable_withdrawals?"disabled":""]),onClick:g=>l.toDetails("withdrawal",d,e.coins[d].disable_withdrawals)},[ve,_(" "+r(e.$t("common.withdrawal").toUpperCase()),1)],10,Ce),s("span",{class:"wallet__action wallet__action--history",onClick:g=>l.toDetails("history",d)},[Te,_(" "+r(e.$t("common.history").toUpperCase()),1)],8,Se)])])]))),128))])):W("",!0)])])])]),s("div",ke,[s("div",Le,[s("div",Me,r(e.$t("common.wallethistory")),1),I(h,{wallethistory:e.wallethistory.list,"cur-page":e.wallethistory.currentPage,"page-count":e.wallethistory.totalPages,"get-pretty-date":l.getPrettyDate,"handle-pagination":l.handlePagination,"update-table":l.updateTable,onPageChange:l.changePage},null,8,["wallethistory","cur-page","page-count","get-pretty-date","handle-pagination","update-table","onPageChange"])])])])])}var De=b(j,[["render",Pe],["__scopeId","data-v-25eac00a"]]);export{De as default};
