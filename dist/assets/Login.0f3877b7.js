import{R as T}from"./vue-recaptcha.es.34e22086.js";import{M as F}from"./ModalPagesHeader.a711d36d.js";import{a as v,_ as P,r as h,b,o as r,c as n,n as i,d as l,e as o,t as a,f as u,w as y,g as d,v as $,h as m,i as I,j as L,k as f,F as M,l as D,m as _}from"./index.8b30e6a1.js";import{e as B}from"./errorHundle.1358d0d5.js";import{I as z}from"./InfoModal.2531ed76.js";import"./MainLogo.14cfea8b.js";var E={data(){return{username:"",usernameFixed:!1,password:"",errorspassword:0,errorsemail:0,showGoogleCodeInput:!1,googlecode:"",errtext:"",captchaIsON:!1,showPassword:!1,dangertext:{},isLoading:!1,captcha:""}},computed:{isInvalidFaCode(){return this.googlecode.length!==6}},methods:{handleCaptcha(e){this.captcha=e},formatGoogleCode(){this.googlecode=this.googlecode.replace(/\D/g,"")},whatSiteKey(){return this.localConfig.vue_v},onExpired(){this.$refs.recaptcha.reset()},checkProfile(){this.$store.dispatch("core/getProfile").then(this.processLoginRedirect,e=>{console.error(e)})},processLoginRedirect(e){const t=this.$route.query.redirectFrom;e.interface===null?this.$router.push("/interface-select"):t?window.location.replace("account"+t):window.location.replace("account/trade/BTC-USDT")},enterGoogleCode(e){if(this.isInvalidFaCode){setTimeout(()=>{this.errtext=this.$t("common.invalid_code")},300);return}this.errtext="";let t={username:this.username,password:this.password,googlecode:this.googlecode};e&&(t.captcha=e),v.config.globalProperties.$http.post("auth/login/",t).then(c=>{localStorage.setItem("token",c.data.access_token),localStorage.setItem("refresh_token",c.data.refresh_token),localStorage.removeItem("show_security_notice"),this.$store.dispatch("core/loginSuccess"),this.checkProfile()}).catch(this.parseLoginError).finally(this.resetAndShowCaptcha)},validateForm(){let e=0;return this.password.length?this.errorspassword=!1:(this.errorspassword=!0,e=e+1),this.username.length?this.errorsemail=!1:(this.errorsemail=!0,e=e+1),e===0},validateData(){return this.validateForm()},parseLoginError(e){e.status===500?(this.dangertext.wrong_data=this.$t("common.wrong_data"),this.$notify({type:"error",title:"",text:this.$t("common.wrong_data")})):B.parse(e,this,["wrong_data","wrong_captcha","bad_captcha","email_not_verified","2fa_failed","wrong_2fa_many_times"]),this.resetAndShowCaptcha()},handleLogin(){if(this.validateData()){let e={username:this.username,password:this.password,captcha:this.captcha};this.isLoading=!0,v.config.globalProperties.$http.post("auth/login/",e).then(t=>{localStorage.setItem("token",t.data.access_token),localStorage.setItem("refresh_token",t.data.refresh_token),localStorage.removeItem("show_security_notice"),this.$store.dispatch("core/loginSuccess"),this.checkProfile()}).catch(this.parseLoginError).finally(()=>{this.resetAndShowCaptcha,setTimeout(()=>{this.isLoading=!1},500)})}},resetAndShowCaptcha(){this.$refs.recaptcha&&this.$refs.recaptcha.reset()},on2FATooManyTimes(){this.$modal.show(z,{notification:{title:this.$t("common.notification"),text:this.$t("common.wrong_2fa_code_multiple_times")},callback:()=>{this.googlecode="",this.showGoogleCodeInput=!1,this.dangertext={},this.username="",this.password=""},buttonText:this.$t("common.continue")})}}};const V={name:"LoginPage",metaInfo(){return{title:this.$t("pages.titles.login"),meta:[{name:"description",content:`${this.localConfig.project_title} ${this.$t("pages.loginDescription")}`}]}},components:{VueRecaptcha:T,ModalPagesHeader:F},mixins:[E],computed:{getFilteredDangerText(){return Object.fromEntries(Object.entries(this.dangertext).filter(([e,t])=>e&&t&&t!==""))}},beforeCreate(){localStorage.getItem("token")&&this.$router.push("/trade/BTC-USDT"),localStorage.setItem("showDepositNoticeModal","1"),localStorage.getItem("justactivate")==="true"?setTimeout(()=>{this.$notify({type:"success",title:"",text:`
            ${this.$t("common.modalacctiv")} -
            ${this.$t("common.modallogin")}
          `}),localStorage.setItem("justactivate","false")},1100):localStorage.getItem("resetpass")==="true"&&setTimeout(()=>{this.$notify({type:"success",title:"",text:`
            ${this.$t("common.modalpasschange1")} -
            ${this.$t("common.modalpasschange2")}
          `}),localStorage.setItem("resetpass","false")},1100)},methods:{goTo1Step(){this.usernameFixed=!1,this.captchaIsON=!1,this.captchaResponse="",this.dangertext={}},reload(){location.reload()}}},N={class:"auth"},x={class:"mb-4"},G={class:"input-group mb-4 border-1 relative"},R=["type"],j={class:"input-group-append absolute",style:{top:"6px",right:"4px"}},A={class:"show-password-icon",width:"20",height:"20",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},O=o("path",{d:"M555 1335l78-141q-87-63-136-159t-49-203q0-121 61-225-229 117-381 353 167 258 427 375zm389-759q0-20-14-34t-34-14q-125 0-214.5 89.5t-89.5 214.5q0 20 14 34t34 14 34-14 14-34q0-86 61-147t147-61q20 0 34-14t14-34zm363-191q0 7-1 9-106 189-316 567t-315 566l-49 89q-10 16-28 16-12 0-134-70-16-10-16-28 0-12 44-87-143-65-263.5-173t-208.5-245q-20-31-20-69t20-69q153-235 380-371t496-136q89 0 180 17l54-97q10-16 28-16 5 0 18 6t31 15.5 33 18.5 31.5 18.5 19.5 11.5q16 10 16 27zm37 447q0 139-79 253.5t-209 164.5l280-502q8 45 8 84zm448 128q0 35-20 69-39 64-109 145-150 172-347.5 267t-419.5 95l74-132q212-18 392.5-137t301.5-307q-115-179-282-294l63-112q95 64 182.5 153t144.5 184q20 34 20 69z"},null,-1),X=[O],U={class:"show-password-icon",width:"20",height:"20",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},H=o("path",{d:"M1664 960q-152-236-381-353 61 104 61 225 0 185-131.5 316.5t-316.5 131.5-316.5-131.5-131.5-316.5q0-121 61-225-229 117-381 353 133 205 333.5 326.5t434.5 121.5 434.5-121.5 333.5-326.5zm-720-384q0-20-14-34t-34-14q-125 0-214.5 89.5t-89.5 214.5q0 20 14 34t34 14 34-14 14-34q0-86 61-147t147-61q20 0 34-14t14-34zm848 384q0 34-20 69-140 230-376.5 368.5t-499.5 138.5-499.5-139-376.5-368q-20-35-20-69t20-69q140-229 376.5-368t499.5-139 499.5 139 376.5 368q20 35 20 69z"},null,-1),K=[H],J={class:"mb-3"},Q={class:"text-center"},W=["disabled","value"],Y={style:{color:"royalblue"}},Z={class:"text-center"},ee={class:"logIn__register",style:{"border-radius":"25px",background:"#ffd54f !important"}},te={class:"flex flex-col box white"},oe=o("div",{class:"logIn__title",style:{"max-width":"600px"}},"2FA",-1),se={class:"logIn__descr mb-4"},ae={key:0,class:"text-danger mb-4"},re=["disabled"],ne=["value"];function ie(e,t,c,le,de,p){const w=h("ModalPagesHeader"),k=h("vue-recaptcha"),g=h("router-link"),C=b("pattern"),q=b("numeric");return r(),n("div",N,[e.showGoogleCodeInput?(r(),n("div",{key:1,class:"logIn pb-5",style:i([{"text-align":"center"},e.loginBackground?`background: ${e.loginBackground} !important`:{}])},[l(w),o("div",te,[oe,o("div",se,[o("strong",null,a(e.$t("common.entergooglecode")),1)]),o("form",{class:"logIn_form",autocomplete:"off",onSubmit:t[8]||(t[8]=y(s=>e.enterGoogleCode(),["prevent"]))},[d(o("input",{ref:"googlecodeinput","onUpdate:modelValue":t[6]||(t[6]=s=>e.googlecode=s),name:"googlecode",maxlength:"6",autocomplete:"google2fa",pattern:"[0-9]{6}",placeholder:"XXX XXX",class:"secretclass1 mb-4",type:"text",onInput:t[7]||(t[7]=(...s)=>e.formatGoogleCode&&e.formatGoogleCode(...s))},null,544),[[$,e.googlecode],[q,void 0,void 0,{number:!0}]]),e.errtext?(r(),n("p",ae,a(e.errtext),1)):I("",!0),o("button",{disabled:e.isInvalidFaCode,class:"logIn__form__input logIn__form__input_button block",style:i(e.mainColor?`background: ${e.mainColor} !important`:{}),type:"submit"},a(e.$t("common.login_upper")),13,re)],32),o("input",{class:"forgot-password__button forgot-password__button_red logIn__form__input logIn__form__input_button back-button",type:"button",value:e.$t("common.back_to_login"),onClick:t[9]||(t[9]=s=>p.reload())},null,8,ne)])],4)):(r(),n("div",{key:0,class:"logIn pb-5",style:i(e.loginBackground?`background: ${e.loginBackground} !important`:{})},[l(w),o("div",{class:m(["flex box white flex-col",{isBlur:e.isLoading}])},[o("div",{class:"logIn__title",style:i(e.loginText?`color: ${e.loginText} !important`:{})},a(e.$t("common.login")),5),e.usernameFixed?(r(),n("div",{key:1,class:"logIn__descr",style:i(e.loginText?`color: ${e.loginText} !important`:{})},[u(a(e.$t("common.enterPass"))+" ",1),o("p",x,[u(a(e.username)+" ",1),o("span",{class:"change",onClick:t[0]||(t[0]=(...s)=>p.goTo1Step&&p.goTo1Step(...s))},a(e.$t("common.change")),1)])],4)):(r(),n("div",{key:0,class:"logIn__descr",style:i([{"max-width":"302px"},e.loginText?`color: ${e.loginText} !important`:{}])},a(e.$t("common.useemail")),5)),o("form",{class:"logIn__form",onSubmit:t[5]||(t[5]=y(()=>{},["prevent"]))},[e.usernameFixed?I("",!0):d((r(),n("input",{key:0,id:"emailinp",ref:"username","onUpdate:modelValue":t[1]||(t[1]=s=>e.username=s),type:"text",name:"usname",class:m([{"input-has-error":e.errorsemail},"logIn__form__input"]),placeholder:"Email"},null,2)),[[$,e.username],[C,void 0,"email"]]),o("div",G,[d(o("input",{id:"passinp",ref:"passwordInput","onUpdate:modelValue":t[2]||(t[2]=s=>e.password=s),class:m(["form-control logIn__form__input border-0",{"input-has-error":e.errorspassword}]),type:e.showPassword?"text":"password",name:"pass",placeholder:"Password"},null,10,R),[[L,e.password]]),o("div",j,[o("button",{class:"btn border-0 show-password-icon-btn",type:"button",onClick:t[3]||(t[3]=s=>e.showPassword=!e.showPassword)},[d((r(),n("svg",A,X,512)),[[f,!e.showPassword]]),d((r(),n("svg",U,K,512)),[[f,e.showPassword]])])])]),o("div",J,[d(l(k,{ref:"recaptcha",sitekey:e.localConfig.recaptcha_site_key,style:{display:"table"},onVerify:e.handleCaptcha,onExpired:e.onExpired},null,8,["sitekey","onVerify","onExpired"]),[[f,e.usernameFixed]])]),(r(!0),n(M,null,D(p.getFilteredDangerText,(s,S)=>(r(),n("p",{key:S,class:"text-danger",style:{width:"304px"}},a(s),1))),128)),o("div",Q,[o("input",{id:"loginbtn",name:"btn",style:i(e.mainColor?`background: ${e.mainColor}`:{}),class:m(["logIn__form__input logIn__form__input_button opacitychangebtn cursor-pointer inline-block",{"blocked-btn":e.captchaIsON&&!e.captchaResponse}]),type:"submit",disabled:e.captchaIsON&&!e.captchaResponse,value:e.usernameFixed?e.$t("common.login_upper"):e.$t("common.continue"),onClick:t[4]||(t[4]=(...s)=>e.handleLogin&&e.handleLogin(...s))},null,14,W)]),l(g,{to:"/forgot",class:"logIn__recovery mb-4",style:i(e.loginText?`color: ${e.loginText} !important`:{})},{default:_(()=>[o("span",Y," Forget your password ? "+a(e.$t("common.passwordrecovery")),1)]),_:1},8,["style"]),l(g,{to:"/support",class:"logIn__recovery mb-4",style:i(e.loginText?"color: #ffd54f !important":{}),rel:"noopener noreferrer nofollow",target:"_blank"},{default:_(()=>[u(a(e.$t("common.support")),1)]),_:1},8,["style"])],32),o("div",{class:"text-center mb-2",style:i([{"font-size":"14px"},e.loginText?`color: ${e.loginText} !important`:{}])},a(e.$t("common.or")),5),o("div",Z,[l(g,{to:"/register"},{default:_(()=>[o("button",ee,a(e.$t("common.register")),1)]),_:1})])],2)],4))])}var fe=P(V,[["render",ie]]);export{fe as default};
