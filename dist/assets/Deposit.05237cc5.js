import{_ as g,o as c,c as d,e as s,t as i,Q as D,P as W,R as T,r as k,F as B,d as _,i as h,f as m,h as O,n as I,B as L,C as M,U as b,y as H,V as F,W as R,X as x}from"./index.8b30e6a1.js";import{g as E,f as U}from"./getRegularNumber.a168e36c.js";import{W as j}from"./WalletHistory.4d4db630.js";import{q as z}from"./qrcode.5c4c2f7c.js";import{_ as N,S as q}from"./SelectAdvanced.4865e5c6.js";import{S as V}from"./SecurityNoticeModal.0dee1ea1.js";import{I as X}from"./InfoModal.fb2c8c4b.js";const Q={props:{address:{type:String,required:!0}},computed:{shortAddress(){return this.address.length>20?this.address.slice(0,10)+"..."+this.address.slice(this.address.length-10):this.address}},methods:{select(){const e=window.getSelection();e.rangeCount>0&&e.removeAllRanges();const t=document.createRange();t.selectNode(this.$el),e.addRange(t)},onCopy(e){e.clipboardData.setData("text/plain",this.address),e.preventDefault()}}};function J(e,t,o,a,r,n){return c(),d("span",{class:"address-text-field",onCopy:t[1]||(t[1]=(...l)=>n.onCopy&&n.onCopy(...l))},[s("span",{onClick:t[0]||(t[0]=(...l)=>n.select&&n.select(...l))},i(n.shortAddress),1)],32)}var G=g(Q,[["render",J],["__scopeId","data-v-36582d2f"]]);const K={name:"WalletDepositAddress",components:{AddressTextField:G},mixins:[D,E,W],props:{coin:{type:Object,default:()=>{}},ticker:{type:String,default:""},blockchain:{type:String,default:""},title:{type:Boolean,default:!0}},data(){return{qrCode:"",isLoading:!1}},computed:{...T({coinsCommons:"core/coinsCommons"}),blockchainCurrency(){return this.blockchain},currencyNewtwor(){return this.blockchain==="ETH"?this.$t("common.ethereum_network"):this.blockchain==="BNB"?this.$t("common.binance_network"):this.blockchain==="TRX"?this.$t("common.tron_network"):""},checkingBlockchainCurrencyAddress(){return this.blockchain&&this.coin.address?this.blockchain===this.coin.address.blockchain_currency:this.coin.address}},watch:{coin(e){this.makeQR(e.address.address)},deep:!0},mounted(){this.coin.address&&setTimeout(()=>{this.makeQR(this.coin.address.address)},1e3)},methods:{toFxd(e,t){return e?parseFloat(e).toFixed(t):0},createAddress(e){let t={currency:e};this.blockchainCurrency&&(t.blockchain_currency=this.blockchainCurrency),this.isLoading=!0,this.$http.post("create_new_wallet/",t).then(o=>{this.isLoading=!1,this.coin.address=o.data[0],this.makeQR(this.coin.address.address)},()=>{this.isLoading=!1})},makeQR(e){if(this.isBlockedByPhoneVerification)return;let a=z(0,"L");a.addData(e),a.make(),this.qrCode=a.createDataURL(8,6)}}},u=e=>(L("data-v-6eb52d26"),e=e(),M(),e),Y={class:"wallet-modal deposit-address"},Z={class:"address__label"},ee={style:{"min-width":"70%",position:"relative","margin-bottom":"30px"}},te={key:0,style:{width:"100%","padding-right":"42px"}},se={key:1,style:{width:"100%","padding-right":"42px"}},oe=u(()=>s("img",{src:b,width:"12",height:"12"},null,-1)),ie=[oe],ne=u(()=>s("img",{src:b,width:"12",height:"12"},null,-1)),ae=[ne],re={key:0,class:"address__label"},ce={key:1,style:{"min-width":"70%",position:"relative","margin-bottom":"30px"}},de={style:{width:"100%"}},le=u(()=>s("img",{src:b,width:"12",height:"12"},null,-1)),he=[le],ue={class:"deposit__minMax"},me=u(()=>s("div",{class:"deposit__minMax-blockLeft"},[s("img",{src:N,width:"30",height:"30"})],-1)),_e={class:"deposit__minMax-blockCenter"},pe=u(()=>s("br",null,null,-1)),ge={class:"font-weight-bold"},fe={class:"deposit__minMax-blockRight"},ye=u(()=>s("br",null,null,-1)),ke={class:"font-weight-bold"},be={class:"pb-4 flex justify-center"},we=u(()=>s("img",{src:N,class:"mr-8",width:"30",height:"30"},null,-1)),ve={class:"text-left"},Ce=u(()=>s("br",null,null,-1)),Se={class:"font-weight-bold"},$e={class:"text-danger mb-3 px-4 block font-weight-bold",style:{"text-transform":"uppercase","font-size":"16px"}},Pe={key:0},Ae={key:2},Be={class:"font-weight-bold",style:{"font-size":"16px"}},De={key:3},We={class:"text-danger",style:{"font-size":"16px"}},Te={key:4,style:{width:"90%",margin:"0 auto","text-transform":"uppercase"}},Le={class:"text-danger",style:{"font-size":"16px"}},Me={key:5,style:{margin:"20px auto"},class:"text-center"},Ne=["src"],Oe={class:"title",style:{color:"#a5b3a7","font-size":"16px","text-transform":"uppercase"}},Ie={style:{"text-align":"center","font-size":"20px"}},He={class:"blockchain-currency"},Fe=["disabled"],Re={key:0,class:"loader"};function xe(e,t,o,a,r,n){var p,f,w,v,C,S,$,P,A;const l=k("AddressTextField");return c(),d("div",Y,[n.checkingBlockchainCurrencyAddress?(c(),d(B,{key:0},[s("div",Z,i(e.$t("common.address")),1),s("div",ee,[["XRP","EOS"].includes(o.ticker)?(c(),d("div",te,[_(l,{address:o.coin.disable_topups?e.$t("common.deposits_disabled"):o.coin.address.main_address},null,8,["address"])])):(c(),d("div",se,[_(l,{address:o.coin.disable_topups?e.$t("common.deposits_disabled"):o.coin.address.address},null,8,["address"])])),["XRP","EOS"].includes(o.ticker)?(c(),d("button",{key:2,class:"btn address_btn",onClick:t[0]||(t[0]=y=>e.copyToBuffer(o.coin.address.main_address))},ie)):(c(),d("button",{key:3,class:"btn address_btn",onClick:t[1]||(t[1]=y=>e.copyToBuffer(o.coin.address.address))},ae))]),["XRP","EOS"].includes(o.ticker)?(c(),d("div",re,i(e.$t("common.addressTag")),1)):h("",!0),["XRP","EOS"].includes(o.ticker)?(c(),d("div",ce,[s("div",de,[_(l,{address:o.coin.address.address},null,8,["address"])]),s("button",{class:"btn address_btn",onClick:t[2]||(t[2]=y=>e.copyToBuffer(o.coin.address.address))},he)])):h("",!0),s("div",ue,[me,s("div",_e,[m(i(e.$t("common.mindepositamount"))+" ",1),pe,s("strong",ge,i(e.addSpace((f=(p=o.coin)==null?void 0:p.limits)==null?void 0:f.deposit.min))+" "+i(o.ticker),1)]),s("div",fe,[m(i(e.$t("common.maxdepositamount"))+" ",1),ye,s("strong",ke,i(e.addSpace((v=(w=o.coin)==null?void 0:w.limits)==null?void 0:v.deposit.max))+" "+i(o.ticker),1)])]),s("div",be,[we,s("div",ve,[m(i(e.$t("common.second_table_deposit_fee"))+" ",1),Ce,s("strong",Se,i(n.toFxd(e.getRegularNumber(($=(S=(C=o.coin)==null?void 0:C.fee)==null?void 0:S.deposit)==null?void 0:$.address),8))+" "+i(o.ticker),1)])]),s("p",$e,[m(i(e.$t("common.mindepositalert"))+" ",1),["ETH","USDT"].includes(o.ticker)?(c(),d("span",Pe,i(e.$t("wallet.contract_funds_are_ignored")),1)):h("",!0)]),["BNB"].includes(o.ticker)?(c(),d("p",Ae,[s("strong",Be,i(e.$t("wallet.binance_smart_chain_text")),1)])):h("",!0),["XRP","EOS"].includes(o.ticker)?(c(),d("p",De,[s("span",We,i(e.$t("wallet.dest_tag_required")),1)])):h("",!0),(A=(P=o.coin)==null?void 0:P.blockchain_list)!=null&&A.length?(c(),d("p",Te,[s("span",Le,i(e.$t("common.depositOnly",{blockchain:e.coinsCommons.blockchainDefinitions[o.blockchain]})),1)])):h("",!0),o.coin.disable_topups?h("",!0):(c(),d("div",Me,[s("img",{src:r.qrCode,alt:"",class:"inline-block"},null,8,Ne)])),s("p",Oe,i(e.$t("common.coinsafter1")),1)],64)):(c(),d(B,{key:1},[s("p",Ie,i(e.$t("common.createyournew"))+" "+i(o.ticker)+" "+i(e.$t("common.address")),1),s("div",He,[s("span",null,i(e.$t("common.blockchain_currency"))+" "+i(n.blockchainCurrency),1)]),s("button",{class:O(["btn btn-create",{"fs-0":r.isLoading}]),style:I(e.mainColor?`background: ${e.mainColor} !important`:{}),disabled:r.isLoading,onClick:t[3]||(t[3]=y=>n.createAddress(o.ticker))},[m(i(e.$t("common.create"))+" ",1),r.isLoading?(c(),d("span",Re)):h("",!0)],14,Fe)],64))])}var Ee=g(K,[["render",xe],["__scopeId","data-v-6eb52d26"]]);const Ue={name:"DepositModal",emits:["close"],methods:{close(){this.$modal.close()}}},je=e=>(L("data-v-397618ca"),e=e(),M(),e),ze={class:"modal-dialog wallet-modal",role:"document"},qe={class:"modal-content"},Ve={class:"modal-body"},Xe={class:"text-capitalize",style:{color:"red !important"}},Qe={class:"security-notice"},Je={class:"font-bold text-center",style:{color:"red"}},Ge=je(()=>s("br",null,null,-1)),Ke={class:"text-center"};function Ye(e,t,o,a,r,n){return c(),d("div",ze,[s("div",qe,[s("div",Ve,[s("div",null,[s("h3",Xe,i(e.$t("common.deposit_modal.title")),1),s("div",Qe,[s("p",Je,[m(i(e.$t("common.deposit_modal.text")),1),Ge,m(i(e.$t("common.deposit_modal.subtext")),1)]),s("div",Ke,[s("button",{type:"button",class:"btn btn-primary btn-block py-2",onClick:t[0]||(t[0]=(...l)=>n.close&&n.close(...l))},i(e.$t("common.ok")),1)])])])])])])}var Ze=g(Ue,[["render",Ye],["__scopeId","data-v-397618ca"]]);const et={name:"WalletDeposit",metaInfo(){return{title:this.$t("pages.wallet"),meta:[{name:"description",content:`${this.localConfig.project_title} ${this.$t("pages.walletDescription")}`}]}},components:{SelectAdvanced:q,WalletHistory:j},mixins:[W,D],data(){var e,t;return{selectedCoin:"",openedAction:"",networksList:[],selectedDefault:(t=(e=this.$route)==null?void 0:e.params)==null?void 0:t.walletitem,openedActionProperties:{},createCodePending:!1,payout_form_view:"pending",errorMSGwithADVCASH:"",currencyWWWwithINTERKASSA:"USDT",curPage:1,txscount:0,amountOnPage:10,amountOfPages:1,timers:[],resend_loader:{},floor10:U}},computed:{...T({coins:"core/coins",profile:"core/profile",isConnectedSocket:"isConnectedSocket",wsUserIsAuthenticated:"wsUserIsAuthenticated",user_notification:"core/user_notification",walletTopupsHistory:"core/walletTopupsHistory",reconnectError:"reconnectError",lockedBalance:"core/lockedBalance"}),filteredCoins(){return Object.fromEntries(Object.entries(this.coins).filter(([,e])=>e.active&&!e.disable_all))}},watch:{isConnectedSocket(e){e&&localStorage.getItem("token")&&this.$store.dispatch("sendWSMessage",JSON.stringify({token:localStorage.getItem("token")}))},wsUserIsAuthenticated(e){e&&(this.getBalance(),this.getLockedBalance(),this.getWalletHistory())},user_notification(e){e.length&&this.$modal.show(X,{},{adaptive:!0,height:"auto",scrollable:!0,width:500})},reconnectError(e){e&&(this.updateWalletHistory(this.curPage,this.amountOnPage),this.updateBalance())},deep:!0},mounted(){localStorage.getItem("showDepositNoticeModal")&&(this.showDepositNoticeModal(),localStorage.removeItem("showDepositNoticeModal")),this.$store.dispatch("core/getCoinsLimits"),this.loadWallets(),this.showSecurityNotice(),this.$store.dispatch("core/getUserNotifications"),this.isConnectedSocket&&(localStorage.getItem("token")&&this.$store.dispatch("sendWSMessage",JSON.stringify({token:localStorage.getItem("token")})),this.wsUserIsAuthenticated&&(this.getBalance(),this.getLockedBalance(),this.getWalletHistory())),setTimeout(()=>{var e,t;this.coinSelected((t=(e=this.$route)==null?void 0:e.params)==null?void 0:t.walletitem,this.coins)},300)},beforeUnmount(){for(this.unsubscribeWsData();this.timers.length;)clearTimeout(this.timers.shift())},methods:{showDepositNoticeModal(){this.$modal.show(Ze,{},{adaptive:!0,height:"auto",scrollable:!0,width:500})},coinChoose(e){this.$store.dispatch("core/getCoinsLimits"),this.$route.params.walletitem!==e&&this.$router.push({name:"wallet-deposit",params:{walletitem:e}})},coinSelected(e,t){t?this.selectedCoin={coin:e,...t[e]}:(this.selectedDefault="",this.selectedCoin={coin:e,...this.filteredCoins[e]}),this.networksList={},this.blockchainCurrencyByCoin(this.selectedCoin).length===0&&(this.networksList[this.selectedCoin.name]={id:this.selectedCoin.name,name:this.$t("common.address"),action:()=>this.depositAddressHandler(this.selectedCoin,this.selectedCoin.coin)}),this.blockchainCurrencyByCoin(this.selectedCoin).map(o=>{this.networksList[o.name]={id:o.name,name:this.$t("common.address"),action:()=>this.depositAddressHandler(this.selectedCoin,this.selectedCoin.coin,o.code)}}),this.networksList[Object.values(this.networksList)[0].id].action()},networkSelected(e){this.networksList[e].action()},blockchainCurrencyByCoin(e){return e.blockchain_list?e.blockchain_list.map(t=>({code:t,name:t})):[]},formatingCommission(e){const t=Object.values(e);return t.length>1?`${Math.min(...t)} - ${Math.max(...t)}`:t.length===1?`${t[0]}`:"0"},formatingBalanceAndOrder(e){return e!==0?e.toFixed(8):e.toFixed()},showLockedBalance(e){return this.lockedBalance[e]},getCoinWithdrawalFee(e){return e.fee.withdrawal[this.$config.currentWithdrawCardPaySystem]},getCoinDepositFee(e){return e.fee.deposit[this.$config.currentTopUpCardPaySystem]},fromPagetoLimits(e){let t=this.amountOnPage,o=t*(e-1);return{limit:t,offset:o,pageNum:e}},getPageCount(){return this.amountOfPages},changePage(e){this.curPage=e},handlePagination(e){this.changePage(e),this.reconnectError?this.updateWalletHistory(e,this.amountOnPage):this.getWalletHistory(e,this.amountOnPage,!0)},depositAddressHandler(e,t,o){let a={...e},r=null;o&&(a.address&&a.address.length&&(a.address.forEach(n=>{n.blockchain_currency===o&&(r=n)}),a.address=r),a.address&&a.address.length<1&&(a.address=null)),this.openedAction=Ee,this.openedActionProperties={coin:a,ticker:t,blockchain:o}},getPrettyDate(e){let t=new Date;return t.setTime(parseInt(e)*1e3),t.toLocaleString("ru-RU")},updateTable(){this.getWalletHistory(this.curPage,this.amountOnPage,!0),this.reconnectError&&this.updateWalletHistory(this.curPage)},sendSocketMessage(e,t,o,a){let r={command:e};t&&Object.keys(t)&&(r.params=t),a&&(r.token=localStorage.getItem("token")||null),o&&(r.params.pair_name=`${this.currentPair[0]}-${this.currentPair[1]}`),this.$store.dispatch("sendWSMessage",JSON.stringify(r))},getBalance(){this.sendSocketMessage("add_balance",{},!1,!0)},getLockedBalance(){this.sendSocketMessage("add_locked_balance",{},!1,!0)},updateBalance(){this.$store.dispatch("core/getBalance")},updateWalletHistory(e,t){let o=t*(e-1);this.$store.dispatch("core/getWalletTopupsHistory",{limit:t,offset:o,page:e,fc:()=>{this.changePage(e)}})},getWalletHistory(e,t){const o="add_wallet_topups_history";this.reconnectError||this.sendSocketMessage(o,{limit:t||10,page:e||1},!1,!0)},unsubscribeWsData(){this.sendSocketMessage("del_balance",{},!1,!0),this.sendSocketMessage("del_wallet_topups_history",{},!1,!0)},loadWallets(){this.$http.post("getwallets/",{}).then(e=>{e.data.forEach(t=>{this.coins[t.currency]||(this.coins[t.currency]={}),this.coins[t.currency].address||(this.coins[t.currency].address=t),Array.isArray(this.coins[t.currency].address)&&!this.coins[t.currency].address.find(o=>o.address===t.address)&&(this.coins[t.currency].address=[...this.coins[t.currency].address,t]),typeof this.coins[t.currency].address=="object"&&!Array.isArray(this.coins[t.currency].address)&&this.coins[t.currency].address!==null&&this.coins[t.currency].address.address!==t.address&&(this.coins[t.currency].address=[this.coins[t.currency].address,t])})})},showSecurityNoticeModal(){this.$modal.show(V,{},{adaptive:!0,height:"auto",scrollable:!0,width:500})},showSecurityNotice(){localStorage.getItem("show_security_notice")!="OFF"&&this.$http.post("check2fa/").then(t=>{const o=t.data==="OFF",a=!this.profile.withdrawals_sms_confirmation;o&&a&&this.showSecurityNoticeModal()})},formatAmount(e){return parseFloat(e)>0?e:0}}},tt={class:"container-lg"},st={class:"deposit xl:grid grid-cols-5 gap-4"},ot={class:"col-span-2"},it={class:"plate"},nt={class:"wallet__panel"},at={class:"selector"},rt={key:0,class:"selector"},ct={class:"col-span-3"},dt={class:"plate"},lt={class:"wallet__title wallet__title--single"},ht={class:"plate"},ut={class:"wallet__title wallet__title--table"};function mt(e,t,o,a,r,n){const l=k("SelectAdvanced"),p=k("WalletHistory");return c(),d("div",null,[s("div",tt,[s("div",st,[s("div",ot,[s("div",it,[s("div",{class:"plate-back",onClick:t[0]||(t[0]=f=>e.$router.push({name:"wallet"}))},i(e.$t("common.deposit")),1),s("div",nt,[s("div",at,[s("label",null,i(e.$t("common.select_coin")),1),_(l,{items:n.filteredCoins,image:!0,"selected-default":r.selectedDefault,"total-title":e.$t("common.allbalance"),"all-coins":e.coins,onSelect:n.coinChoose},null,8,["items","selected-default","total-title","all-coins","onSelect"])]),Object.keys(r.networksList).length>0?(c(),d("div",rt,[s("label",null,i(e.$t("common.select_network_selector")),1),_(l,{items:r.networksList,"all-coins":e.coins,onSelect:n.networkSelected},null,8,["items","all-coins","onSelect"])])):h("",!0),(c(),H(x(r.openedAction),F(R(r.openedActionProperties)),null,16))])])]),s("div",ct,[s("div",dt,[s("div",lt,i(e.$t("common.walletdeposit_title")),1),s("div",null,i(e.$t("common.walletdeposit_text")),1)]),s("div",ht,[s("div",ut,i(e.$t("common.deposit_history")),1),_(p,{wallethistory:e.walletTopupsHistory.list,"cur-page":e.walletTopupsHistory.currentPage,"page-count":e.walletTopupsHistory.totalPages,"get-pretty-date":n.getPrettyDate,"handle-pagination":n.handlePagination,"update-table":n.updateTable,onPageChange:n.changePage},null,8,["wallethistory","cur-page","page-count","get-pretty-date","handle-pagination","update-table","onPageChange"])])])])])])}var wt=g(et,[["render",mt],["__scopeId","data-v-29219a58"]]);export{wt as default};
