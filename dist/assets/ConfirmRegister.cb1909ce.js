import{M as u}from"./MainLogo.14cfea8b.js";import{_,r as f,o as a,c as m,d as g,e as o,t as i,g as p,v as h,F as b,f as v,i as y,w as I,n as k}from"./index.8b30e6a1.js";const w={components:{MainLogo:u},data(){return{showBanner:!1,token:this.$route.params.token,timer:300,awaitSeconds:300,confirmationCode:"",email:""}},mounted(){const e=localStorage.getItem("confirm-email");this.email=this.$route.query.login_email||"",e&&(this.showBanner=!0,this.runTimer())},methods:{resendCode(){this.$http.post("auth/registration/resend-email/",{email:this.email}).then(this.runTimer)},cancel(){this.$router.push("/login")},runTimer(){let e=localStorage.getItem("confirm-email")||`${Math.round(new Date().getTime()/1e3)}`;this.showBanner=!0,localStorage.setItem("confirm-email",e);const t=()=>{const c=`${Math.round(new Date().getTime()/1e3)}`;e&&(this.timer>1?this.showBanner=!0:(localStorage.removeItem("confirm-email"),this.timer=this.awaitSeconds,this.showBanner=!1,location.reload(),clearInterval(l)),this.timer=this.awaitSeconds+(parseFloat(e)-parseFloat(c)))};t();let l=setInterval(t,1e3)},confirmEmail(){this.$http.post("auth/registration/verify-email/",{key:this.confirmationCode}).then(()=>{this.$notify({type:"success",title:"",text:this.$t("common.you_were_registered")}),this.$router.push({name:"login"})}).catch(e=>{var t;((t=e.data)==null?void 0:t.type)==="not_found"&&this.$notify({type:"error",title:"",text:this.$t("common.invalid_code")})})}}},C={class:"flex box white flex-col"},$={class:"logIn__title"},B={class:"logIn__descr mb-4"},S={key:0,class:"logIn__descr mb-4"},T={class:"logIn__form__input logIn__form__input_button block uppercase mb-[13px]",type:"submit"};function M(e,t,l,c,s,r){const d=f("MainLogo");return a(),m("div",{class:"logIn pb-5 confirm_reg_email",style:k(e.loginBackground?`background: ${e.loginBackground} !important`:{})},[g(d),o("div",C,[o("div",$,i(e.$t("common.email_confirmation")),1)]),o("div",B,[o("strong",null,i(e.$t("common.email_sent")),1)]),o("form",{class:"logIn_form",autocomplete:"off",onSubmit:t[3]||(t[3]=I((...n)=>r.confirmEmail&&r.confirmEmail(...n),["prevent"]))},[p(o("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.confirmationCode=n),required:"",autocomplete:"google2fa",class:"text-center mb-4",type:"text"},null,512),[[h,s.confirmationCode]]),s.email?(a(),m(b,{key:0},[s.showBanner?(a(),m("div",S,[o("strong",null,i(e.$t("common.getCode")),1),v(" "+i(e.$t("common.againAfter",{n:s.timer})),1)])):(a(),m("button",{key:1,class:"logIn__form__input logIn__form__input_button !bg-[#ffba38] block uppercase",type:"button",onClick:t[1]||(t[1]=(...n)=>r.resendCode&&r.resendCode(...n))},i(e.$t("common.resend")),1))],64)):y("",!0),o("button",T,i(e.$t("common.confirm_email")),1),o("button",{class:"logIn__register button-red block uppercase mb-[13px]",type:"button",onClick:t[2]||(t[2]=(...n)=>r.cancel&&r.cancel(...n))},i(e.$t("common.cancel")),1)],32)],4)}var V=_(w,[["render",M],["__scopeId","data-v-adfa2e98"]]);export{V as default};
